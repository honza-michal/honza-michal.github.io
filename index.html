<!DOCTYPE html>
<html lang="cs" data-theme="light">

    <!-- Injected: set --sidebar-w from localStorage before CSS to avoid first-paint flash -->
    <script>
        // === Bulletproof sidebar width preload ===
        (function () {
            let saved = localStorage.getItem("sidebar.width.px");
            let w = parseInt(saved, 10);
            if (!isFinite(w) || w < 150 || w > window.innerWidth * 0.9) {
                w = 320;
            }
            document.documentElement.style.setProperty("--sidebar-w", w + "px");
        })();
    </script>

    <style>
        html[data-theme='light'],
        body {
            background: #fff;
            color: #000;
        }
    </style>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Kombinace PRO3 DEBUG</title>

    <link rel="stylesheet" href="assets/styles.css" />

</head>

<body>

    <header>

        <!-- DEBUG/DBG global shim: must load before any other scripts -->
        <script>
            (function () {
                try {
                    if (typeof window.DEBUG !== 'boolean') window.DEBUG = false;
                    if (typeof window.DBG !== 'function')
                        window.DBG = function () {
                            if (window.DEBUG) try {
                                console.debug.apply(console, arguments);
                            } catch (e) { }
                        };
                    if (typeof window.DBGW !== 'function')
                        window.DBGW = function () {
                            if (window.DEBUG) try {
                                console.warn.apply(console, arguments);
                            } catch (e) { }
                        };
                } catch (e) { }
            })();
        </script>

        <!--<h1>Studie modularity</h1>-->

        <div style="flex:1"></div>

        <button id="autoFit" hidden>Auto-zoom</button>

        <label class="themeToggle">
            <input id="themeSwitch" type="checkbox"  class="uiColors" enabled/>
            <span>světlý režim</span>
        </label>

        <button id="exportSVG" data-vis-guard>Export SVG</button>
        <button id="exportPNG" class="primary" data-vis-guard>Export PNG</button>

    </header>

    <div class="layout">

        <!-- ===================== SIDEBAR ===================== -->
        <aside class="sidebar">
			<img src="assets/akk_logo_studie.svg" alt="AKK logo" id="logo">
            <div class="formcol">

                <!-- Project folder -->
                <div class="row" data-vis-guard>
                    <label class="block" style="margin:8px 0; display:block">
                        <div class="dropzone" id="dzProject">
                            <div>
                                <div><strong>Nahraj složku projektu</strong></div>
                                <div class="hint">/assets/bottoms &amp; /assets/tops</div>
                                <div id="projectCounts" class="muted"></div>
                            </div>
                        </div>

                        <input id="pickRoot"
                               type="file"
                               class="visually-hidden-file"
                               multiple
                               webkitdirectory
                               directory />
                    </label>
                </div>

                <!-- Bottom SVG -->
                <div class="row">
                    <label>1. část (spodní) – SVG</label>

                    <div class="dropzone" id="dzBottom">
                        <div>
                            <strong>Přetáhněte SVG</strong>
                            <div class="hint">spodní část</div>
                            <div id="dzBottomMsg" class="muted"></div>
                        </div>
                    </div>

                    <input id="fileL"
                           type="file"
                           accept="image/svg+xml"
                           class="visually-hidden-file" />
                </div>

                <!-- Top SVG -->
                <div class="row">
                    <label>2. část (horní) – SVG</label>

                    <div class="dropzone" id="dzTop">
                        <div>
                            <strong>Přetáhněte SVG</strong>
                            <div class="hint">horní část</div>
                            <div id="dzTopMsg" class="muted"></div>
                        </div>
                    </div>

                    <input id="fileTop"
                           type="file"
                           accept="image/svg+xml"
                           class="visually-hidden-file" />
                </div>

                <!-- Bottom / Top selects -->
                <div class="row" data-vis-guard>
                    <label>
                        Bottom:
                        <select id="pickBottom" class="select-pill"></select>
                    </label>

                    <label>
                        Top:
                        <select id="pickTop" class="select-pill"></select>
                    </label>
                </div>

                <!-- Cycler -->
                <div class="row" data-vis-guard>
                    <label class="ctl-label">kombinace</label>
                    <div id="cycleGroup" class="segmented two cycle-buttons">
                        <button id="cyclePrev" type="button">PŘEDCHOZÍ</button>
                        <button id="cycleNext" type="button">DALŠÍ</button>
                    </div>
                </div>

                <!-- Filters -->
                <div class="row" data-vis-guard>
                    <div class="filters">

                        <h3 class="ctl-label" style="margin:0 0 .5rem 0">filtry</h3>

                        <label class="ctl-label">vstup</label>
                        <div id="fEntrance" class="segmented">
                            <input id="fEntAny" name="fEntrance" type="radio" value="" checked />
                            <label for="fEntAny">ANY</label>

                            <input id="fEntW" name="fEntrance" type="radio" value="vlevo" />
                            <label for="fEntW">←</label>

                            <input id="fEntS" name="fEntrance" type="radio" value="dole" />
                            <label for="fEntS">↓</label>

                            <input id="fEntE" name="fEntrance" type="radio" value="vpravo" />
                            <label for="fEntE">→</label>
                        </div>
												<label class="ctl-label">garáž orientace</label>
						<div id="fGarageOrient" class="segmented">
							<input id="fGAny" name="fGarageOrient" type="radio" value="" checked />
							<label for="fGAny">ANY</label>

							<input id="fGH" name="fGarageOrient" type="radio" value="vodorovně" />
							<label for="fGH">→</label>

							<input id="fGV" name="fGarageOrient" type="radio" value="svisle" />
							<label for="fGV">↑</label>
						</div>

						<label class="ctl-label">vjezd do garáže</label>
						<div id="fGarageEntrance" class="segmented">
							<input id="fGEAny" name="fGarageEntrance" type="radio" value="" checked />
							<label for="fGEAny">ANY</label>

							<input id="fGEW" name="fGarageEntrance" type="radio" value="vlevo" />
							<label for="fGEW">←</label>

							<input id="fGES" name="fGarageEntrance" type="radio" value="dole" />
							<label for="fGES">↓</label>

							<input id="fGEE" name="fGarageEntrance" type="radio" value="vpravo" />
							<label for="fGEE">→</label>
						</div>

                        <div style="margin-top:.5rem"></div>
						
						


                        <label class="ctl-label">místnosti</label>
                        <div id="fRooms" class="segmented stack">
							<input id="fGarage" type="checkbox" />
                            <label for="fGarage">Dedikovaná garáž</label>
							
                            <input id="fToilet" type="checkbox" />
                            <label for="fToilet">Dedikované WC</label>

                            <input id="fLaundry" type="checkbox" />
                            <label for="fLaundry">Dedikovaná prádelna</label>

                            <input id="fFood" type="checkbox" />
                            <label for="fFood">Dedikovaná spíž</label>
                        </div>

                    </div>

                    <div class="filter-actions">
                        <button id="resetFiltry" class="btn full">Resetovat filtry</button>
                    </div>
                </div>

                <!-- Mirror -->
                <div class="row" data-vis-guard>
                    <label>
                        <input id="mirrorTop" type="checkbox"  class="uiColors"/>
                        Zrcadlit horní část ↔
                    </label>
                </div>

                <!-- Wardrobe side -->
                <div class="row" data-vis-guard>
                    <label class="ctl-label">úložné prostory na chodbě</label>
                    <label class="ctl-label" style="font-size: 0.8em;">
                        <input id="wardrobeManual"  class="uiColors" type="checkbox" />
                        Manuální ovládání
                    </label>
                    <div id="wardrobeSwitch" class="segmented two">
                        <input id="wardrobeL" name="wardrobeSide" type="radio" value="left" checked />
                        <label for="wardrobeL">VLEVO</label>

                        <input id="wardrobeR" name="wardrobeSide" type="radio" value="right" />
                        <label for="wardrobeR">VPRAVO</label>
                    </div>
                </div>

                <!-- Anchors -->
                <div class="row" data-vis-guard>
                    <label>
                        <input id="showAnchors"  class="uiColors" type="checkbox" />
                        Zobrazit kotvy
                    </label>
                </div>

                <hr />

                <!-- Scale -->
                <div class="row" data-vis-guard>
                    <label>
                        Zvětšení:
                        <span id="scaleVal">100</span>
                        %
                    </label>
                    <input id="scale"
                           type="range"
                           min="10"
                           max="300"
                           step="1"
                           value="100" 
						   class="uiColors"/>
                </div>

            </div>
        </aside>

        <!-- ===================== RESIZER ===================== -->
        <div id="resizer" class="resizer"></div>

        <!-- ===================== PREVIEW ===================== -->
        <main class="preview">

            <div id="scrollMain" class="scrollHost">
                <div class="centerWrap">
                    <div id="stage"></div>
                </div>
            </div>

            <div id="hMirror" class="hMirror">
                <div id="hMirrorInner" class="hMirrorInner"></div>
            </div>

        </main>

    </div>

    <!-- Meta JSON (autogenerated by autoload) -->
    <script id="meta" type="application/json"></script>

    <!-- TEMPDBG overlay will attach itself on load -->
    <script></script>

    <script defer src="src/utils/debugOverlay.js"></script>
    <script type="module" src="src/ui/toolkit.js"></script>
    <script type="module" src="src/boot/main.js"></script>
    <script type="module" src="src/boot/enableSvgPart.js"></script>

</body>
</html>
