
export const filtry={orientaceVstupu:'',orientaceGaraze:'',vjezdGaraze:'',samostatneWC:false,samostatnaPradelna:false,spiz:false,samostatnaGaraz:false};
export function normalizeUIFilters(f){const out={}; for(const[k,v]of Object.entries(f||{})){ if(v===undefined||v===null||v===''||v===false||(Array.isArray(v)&&!v.length)||v==='any') continue; out[k]=v; } return out; }
function getFeature(obj,path){ if(!obj||!path) return undefined; const roots=[obj,obj.vlastnosti,obj.features,obj.properties].filter(Boolean); const segs=String(path).split('.'); for(const root of roots){ let cur=root, ok=true; for(const s of segs){ if(cur && Object.prototype.hasOwnProperty.call(cur,s)) cur=cur[s]; else { ok=false; break; } } if(ok) return cur; } return undefined; }
function singleFilterPasses(part,key,val){ if(val===undefined||val===null||val===''||(Array.isArray(val)&&!val.length)||val==='any') return true; const feat=getFeature(part,key); if (feat===undefined) return true; if (typeof feat==='boolean'){ if (typeof val==='boolean') return feat===val; if (val==='true') return feat===true; if (val==='false') return feat===false; return true; } if (Array.isArray(feat)) return Array.isArray(val)? val.some(v=>feat.includes(v)) : feat.includes(val); if (typeof feat==='number'){ if (typeof val==='number') return feat===val; if (val && typeof val==='object'){ const {min,max}=val; if (min!=null && feat<+min) return false; if (max!=null && feat>+max) return false; return true; } const n=+val; return Number.isNaN(n)? true : feat===n; } if (typeof feat==='string') return Array.isArray(val) ? val.some(v=>String(feat)===String(v)) : String(feat)===String(val); return true; }
export function partMatchesFilters(part,active){ if(!active) return true; for(const[k,v] of Object.entries(active)) if(!singleFilterPasses(part,k,v)) return false; return true; }
